<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase æ¸¬è©¦ç™»å…¥é é¢ (åƒ…ç™»å…¥)</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    
    <style>
        /* ... æ¨£å¼ä¿æŒä¸è®Š ... */
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f4f7f6;
        }
        .container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        h2 {
            color: #333;
            margin-bottom: 20px;
        }
        input[type="email"], input[type="password"] {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        #loginBtn { background-color: #4CAF50; color: white; }
        #logoutBtn { background-color: #f44336; color: white; }
        button:hover { opacity: 0.9; }
        #status {
            margin-top: 20px;
            padding: 10px;
            border-radius: 4px;
            background-color: #e0e0e0;
            color: #333;
            text-align: left;
        }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Firebase ç¶²é ç™»å…¥</h2>

        <div id="authArea">
            <input type="email" id="emailInput" placeholder="é›»å­éƒµä»¶" required>
            <input type="password" id="passwordInput" placeholder="å¯†ç¢¼" required>
            
            <button id="loginBtn">ç™»å…¥</button>
        </div>

        <div id="profileArea" class="hidden">
            <p><strong>æ­£åœ¨å°å‘è‡³ç§äººé é¢...</strong></p>
        </div>

        <div id="status">ç­‰å¾…ä½¿ç”¨è€…ç™»å…¥...</div>

    </div>

    <script>
        // ğŸš¨ æ­¥é©Ÿ 2: é…ç½®æ‚¨çš„ Firebase è¨­å®š ğŸš¨
        const firebaseConfig = {
        apiKey: "AIzaSyACnoimIASfb1rb59SbgLDkUmyYR6ODbUU",
        authDomain: "llwb-ed686.firebaseapp.com",
        projectId: "llwb-ed686",
        storageBucket: "llwb-ed686.firebasestorage.app",
        messagingSenderId: "940345852074",
        appId: "1:940345852074:web:7a30cca5a6d997a92350d3",
        measurementId: "G-KWL4ZE3D18"
        };
        
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // å®šç¾©ç§äººé é¢çš„ URL
        const PRIVATE_PAGE_URL = 'private.html'; 

        // ç²å– DOM å…ƒç´  (éƒ¨åˆ†ä¸å†éœ€è¦ï¼Œä½†ä¿ç•™ä»¥é˜²è¬ä¸€)
        const emailInput = document.getElementById('emailInput');
        const passwordInput = document.getElementById('passwordInput');
        const loginBtn = document.getElementById('loginBtn');
        const statusDiv = document.getElementById('status');

        function updateStatus(message, isError = false) {
            statusDiv.textContent = message;
            statusDiv.style.backgroundColor = isError ? '#fdd' : '#ddf';
        }

        // --- ç™»å…¥è™•ç†å‡½æ•¸ (ç¶­æŒä¸è®Š) ---
        loginBtn.addEventListener('click', () => {
            const email = emailInput.value;
            const password = passwordInput.value;

            if (!email || !password) {
                updateStatus("è«‹è¼¸å…¥é›»å­éƒµä»¶å’Œå¯†ç¢¼ã€‚", true);
                return;
            }

            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    updateStatus("ç™»å…¥æˆåŠŸï¼Œæ­£åœ¨é‡å®šå‘...");
                    // æˆåŠŸç™»å…¥å¾Œï¼Œç‹€æ…‹ç›£è½å™¨ (onAuthStateChanged) å°‡æœƒè§¸ç™¼é‡å®šå‘
                })
                .catch((error) => {
                    updateStatus(`ç™»å…¥å¤±æ•—: ${error.message}`, true);
                });
        });

        // ğŸ’¡ é—œéµä¿®æ”¹è™•: ç›£è½ä½¿ç”¨è€…ç‹€æ…‹è®ŠåŒ–ä¸¦åŸ·è¡Œé‡å®šå‘ ğŸ’¡
        auth.onAuthStateChanged((user) => {
            if (user) {
                // ä½¿ç”¨è€…å·²ç™»å…¥
                // æª¢æŸ¥ç›®å‰æ˜¯å¦å·²åœ¨ç§äººé é¢ï¼Œé¿å…ç„¡é™é‡å®šå‘å¾ªç’°ï¼ˆé›–ç„¶åœ¨ç™»å…¥é é¢ä¸æœƒç™¼ç”Ÿï¼Œä½†ç¿’æ…£æ€§æª¢æŸ¥ï¼‰
                if (window.location.pathname.endsWith('index.html') || window.location.pathname.endsWith('/')) {
                    // å¦‚æœç›®å‰åœ¨ç™»å…¥é é¢ï¼Œå‰‡å°å‘åˆ°ç§äººé é¢
                    window.location.href = PRIVATE_PAGE_URL = 'https://llwb-ed686.web.app/private.html';
                }
            } else {
                // ä½¿ç”¨è€…å·²ç™»å‡º (æˆ–æœªç™»å…¥)
                // æª¢æŸ¥ç›®å‰æ˜¯å¦åœ¨ç§äººé é¢
                if (window.location.pathname.includes(PRIVATE_PAGE_URL = 'https://llwb-ed686.web.app/private.html')) {
                    // å¦‚æœåœ¨ç§äººé é¢ï¼Œä½†æœªç™»å…¥ï¼Œå‰‡å°å›ç™»å…¥é é¢ (index.html æˆ–å…¶ä»–)
                    window.location.href = 'index.html'; // å‡è¨­ç™»å…¥é é¢æ˜¯ index.html
                }
                // å¦‚æœç›®å‰å°±åœ¨ç™»å…¥é é¢ï¼Œå‰‡ä¸åŸ·è¡Œä»»ä½•æ“ä½œ
            }
        });
    </script>
</body>
</html>