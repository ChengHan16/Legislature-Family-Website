<!DOCTYPE html>
<html lang="zh-TW">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Firebase æ¸¬è©¦ç™»å…¥é é¢</title>
Â  Â  
Â  Â  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
Â  Â  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
Â  Â  
Â  Â  <style>
Â  Â  Â  Â  /* ... æ¨£å¼ä¿æŒä¸è®Š ... */
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  background-color: #f4f7f6;
Â  Â  Â  Â  }
Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  background-color: #ffffff;
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  max-width: 400px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  h2 {
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â  input[type="email"], input[type="password"] {
Â  Â  Â  Â  Â  Â  width: calc(100% - 20px);
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }
Â  Â  Â  Â  button {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  #loginBtn { background-color: #4CAF50; color: white; }
Â  Â  Â  Â  #logoutBtn { background-color: #f44336; color: white; }
Â  Â  Â  Â  button:hover { opacity: 0.9; }
Â  Â  Â  Â  #status {
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  background-color: #e0e0e0;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  text-align: left;
Â  Â  Â  Â  }
Â  Â  Â  Â  .hidden { display: none; }
Â  Â  </style>
</head>
<body>
Â  Â  <div class="container">
Â  Â  Â  Â  <h2>Firebase ç¶²é ç™»å…¥</h2>

Â  Â  Â  Â  <div id="authArea">
Â  Â  Â  Â  Â  Â  <input type="email" id="emailInput" placeholder="é›»å­éƒµä»¶" required>
Â  Â  Â  Â  Â  Â  <input type="password" id="passwordInput" placeholder="å¯†ç¢¼" required>
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  <button id="loginBtn">ç™»å…¥</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="profileArea" class="hidden">
Â  Â  Â  Â  Â  Â  <p><strong>ç™»å…¥æˆåŠŸï¼Œæ­£åœ¨å°å‘è‡³ç§äººé é¢...</strong></p>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="status">ç­‰å¾…ä½¿ç”¨è€…ç™»å…¥...</div>

Â  Â  </div>

Â  Â  <script>
    // ğŸš¨ æ­¥é©Ÿ 1: é…ç½®æ‚¨çš„ Firebase è¨­å®š ğŸš¨
    const firebaseConfig = {
        apiKey: "AIzaSyACnoimIASfb1rb59SbgLDkUmyYR6ODbUU",
        authDomain: "llwb-ed686.firebaseapp.com",
        projectId: "llwb-ed686",
        storageBucket: "llwb-ed686.firebasestorage.app",
        messagingSenderId: "940345852074",
        appId: "1:940345852074:web:7a30cca5a6d997a92350d3",
        measurementId: "G-KWL4ZE3D18"
    };
    
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // âœ… ä¿®æ­£é» 1: PRIVATE_PAGE_URL è®Šæ•¸å¿…é ˆæ˜¯æ­£ç¢ºçš„ Firebase Hosting ç¶²å€
    const PRIVATE_PAGE_URL = 'https://llwb-ed686.web.app/private.html'; 

    // ç²å– DOM å…ƒç´ 
    const emailInput = document.getElementById('emailInput');
    const passwordInput = document.getElementById('passwordInput');
    const loginBtn = document.getElementById('loginBtn');
    const statusDiv = document.getElementById('status');

    function updateStatus(message, isError = false) {
        statusDiv.textContent = message;
        statusDiv.style.backgroundColor = isError ? '#fdd' : '#ddf';
    }

    // --- ç™»å…¥è™•ç†å‡½æ•¸ ---
    loginBtn.addEventListener('click', () => {
        const email = emailInput.value;
        const password = passwordInput.value;

        if (!email || !password) {
            updateStatus("è«‹è¼¸å…¥é›»å­éƒµä»¶å’Œå¯†ç¢¼ã€‚", true);
            return;
        }

        auth.signInWithEmailAndPassword(email, password)
            .then((userCredential) => {
                // æˆåŠŸç™»å…¥å¾Œï¼Œç‹€æ…‹ç›£è½å™¨ (onAuthStateChanged) å°‡æœƒè§¸ç™¼é‡å®šå‘
                updateStatus("ç™»å…¥æˆåŠŸï¼Œæ­£åœ¨é‡å®šå‘...");
            })
            .catch((error) => {
                // é€™è£¡æœƒæ•ç² 400 éŒ¯èª¤ï¼Œé€šå¸¸æ˜¯å¸³è™Ÿå¯†ç¢¼ä¸ç¬¦
                let errorMessage = `ç™»å…¥å¤±æ•—: ${error.message}`;
                if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                    errorMessage = "ç™»å…¥å¤±æ•—: å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤ã€‚";
                }
                updateStatus(errorMessage, true);
            });
    });

    // ğŸ’¡ é—œéµé‚è¼¯: ç›£è½ä½¿ç”¨è€…ç‹€æ…‹è®ŠåŒ–ä¸¦åŸ·è¡Œé‡å®šå‘ ğŸ’¡
    auth.onAuthStateChanged((user) => {
        if (user) {
            // ä½¿ç”¨è€…å·²ç™»å…¥

            // æª¢æŸ¥ç›®å‰æ˜¯å¦åœ¨ç™»å…¥é é¢ (login.html æˆ– root index)
            if (window.location.pathname.endsWith('login.html') || window.location.pathname.endsWith('index.html') || window.location.pathname.endsWith('/')) {
                
                // âœ… ä¿®æ­£é» 2: ä¿®æ­£é‡å®šå‘èªæ³•ï¼Œé€™æ˜¯æ­£ç¢ºçš„è·³è½‰æŒ‡ä»¤
                window.location.href = PRIVATE_PAGE_URL;
            }
        } else {
            // ä½¿ç”¨è€…å·²ç™»å‡º (æˆ–æœªç™»å…¥)
            
            // æª¢æŸ¥ç›®å‰æ˜¯å¦åœ¨ç§äººé é¢ (é€™æ˜¯ login.html çš„å®‰å…¨ç¶²)
            if (window.location.href.includes(PRIVATE_PAGE_URL)) { 
                // å¦‚æœåœ¨ç§äººé é¢ï¼Œä½†æœªç™»å…¥ï¼Œå‰‡å°å› login.html 
                window.location.href = 'login.html'; 
            }
        }
    });
</script>
</body>
</html>

